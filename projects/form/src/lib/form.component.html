<ng-container *ngIf="dynamicForm">
  <form #formElement [formGroup]="dynamicForm" (ngSubmit)="submit()" onsubmit="return false" class="needs-validation">

    <ng-container *ngFor="let fieldsetConfig of config?.fieldset">
      <cat-form-fieldset
        [fieldsetConfig]="fieldsetConfig"
        [highlightInvalidFields]="(highlightInvalidFields$ | async) ?? false"
        (emitFormGroup)="addFormGroup(fieldsetConfig.name, $event)">
      </cat-form-fieldset>
    </ng-container>

    <ng-container *ngFor="let fieldConfig of config?.fields">
      <div
        #containerField
        [ngClass]="'col-' + fieldConfig.grid">
        <cat-form-field
          [fieldConfig]="fieldConfig"
          [highlightInvalidFields]="(highlightInvalidFields$ | async) ?? false"
          (isHiddenField)="hideField(containerField, $event)"
          (emitFormControl)="addFormControl(fieldConfig.name, $event)">
        </cat-form-field>
      </div>
    </ng-container>

  </form>
</ng-container>
